{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst API_KEY = '45339856-2e70ead6ce9cf82bdbbd89c7e';\nconst API_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nlet raiseEmptySearchCriteria = () => {\n    iziToast.show({\n        message: `Fill search field`,\n        position: \"topRight\",\n        backgroundColor: 'rgb(250,128,114)',\n        messageColor: 'rgb(255,255,255)'\n    });\n};\n\nlet raiseEmptyResponse = () => {\n    iziToast.show({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        position: \"topRight\",\n        backgroundColor: 'rgb(250,128,114)',\n        messageColor: 'rgb(255,255,255)'\n    });\n};\n\nexport async function loadData(searchText, page, callbackOnSuccess, callbackOnError, callOnFinally) {\n    if (searchText === null || searchText === \"\") {\n        raiseEmptySearchCriteria();\n        callOnFinally();\n        return;\n    }\n\n    try {\n        const response = await axios.get(API_URL, {\n            params: {\n                key: API_KEY,\n                q: searchText,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: PER_PAGE,\n                page: page\n            },\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        });\n\n        if (response.data.hits.length > 0) {\n            callbackOnSuccess(response.data);\n        } else {\n            raiseEmptyResponse();\n        }\n    } catch (error) {\n        callbackOnError(error);\n    } finally {\n        callOnFinally();\n    }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet box = new SimpleLightbox('ul.results a', { captionsData: 'alt', captionDelay: 250 });\n\nfunction getElement(element) {\n  return `<li class=\"result-item\">\n        <a class=\"result-link\"\n          href=\"${element.largeImageURL}\">\n          <img class=\"result-image\"\n            src=\"${element.webformatURL}\"\n            alt=\"${element.tags}\" />\n          <ul class=\"statistic\">\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Likes</span>\n              <span class=\"likes-number\">${element.likes}</span>\n            </li>\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Views</span>\n              <span class=\"likes-number\">${element.views}</span>\n            </li>\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Comments</span>\n              <span class=\"likes-number\">${element.comments}</span>\n            </li>\n            <li class=\"statistic-item\">\n              <span class=\"likes-title\">Downloads</span>\n              <span class=\"likes-number\">${element.downloads}</span>\n            </li>\n          </ul>\n        </a>\n      </li>`;\n}\n\nexport function render(arrayOfElements) {\n  const update = arrayOfElements.map(el => getElement(el)).join(\"\");\n\n  const gallery = document.querySelector(\"ul.results\");\n  gallery.insertAdjacentHTML(\"afterbegin\", update);\n\n  box.refresh();\n}\n","import { loadData } from './js/pixabay-api';\nimport { render } from './js/render-function';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst mainForm = document.querySelector(\".search\");\nconst loadMoreButton = document.getElementById(\"load-more\");\nlet loader = document.querySelector(\"div.loader-panel\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalLoaded = 0;\nlet totalHits = 0;\n\nfunction showEndOfCollectionMessage() {\n    iziToast.show({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: \"topRight\",\n        backgroundColor: 'rgb(250,128,114)',\n        messageColor: 'rgb(255,255,255)'\n    });\n}\n\nfunction smoothScroll() {\n    const galleryItem = document.querySelector(\".result-item\");\n    if (galleryItem) {\n        const itemHeight = galleryItem.getBoundingClientRect().height;\n        window.scrollBy({\n            top: itemHeight * 2,\n            behavior: 'smooth'\n        });\n    }\n}\n\nmainForm.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n    const searchQuery = mainForm.elements['search-query'].value.trim();\n\n    if (searchQuery !== currentQuery) {\n        currentQuery = searchQuery;\n        currentPage = 1;\n        totalLoaded = 0;\n        totalHits = 0;\n\n        const oldElements = document.querySelectorAll(\"li.result-item\");\n        if (oldElements && oldElements.length > 0) {\n            oldElements.forEach(element => element.remove());\n        }\n    }\n\n    loadMoreButton.style.display = \"none\";\n    loader.style.display = \"block\";\n\n    await loadData(\n        currentQuery,\n        currentPage,\n        (response) => {\n            render(response.hits);\n            totalLoaded += response.hits.length;\n            totalHits = response.totalHits;\n            currentPage++;\n\n            if (totalLoaded < totalHits) {\n                loadMoreButton.style.display = \"block\";\n            } else {\n                showEndOfCollectionMessage();\n            }\n\n            smoothScroll();\n        },\n        (error) => console.error(error),\n        () => loader.style.display = \"none\"\n    );\n});\n\nloadMoreButton.addEventListener(\"click\", async () => {\n    loader.style.display = \"block\";\n    loadMoreButton.style.display = \"none\";\n\n    await loadData(\n        currentQuery,\n        currentPage,\n        (response) => {\n            render(response.hits);\n            totalLoaded += response.hits.length;\n            currentPage++;\n\n            if (totalLoaded < totalHits) {\n                loadMoreButton.style.display = \"block\";\n            } else {\n                showEndOfCollectionMessage();\n            }\n\n            smoothScroll();\n        },\n        (error) => console.error(error),\n        () => loader.style.display = \"none\"\n    );\n});\n"],"names":["API_KEY","API_URL","PER_PAGE","raiseEmptySearchCriteria","iziToast","raiseEmptyResponse","loadData","searchText","page","callbackOnSuccess","callbackOnError","callOnFinally","response","axios","error","box","SimpleLightbox","getElement","element","render","arrayOfElements","update","el","mainForm","loadMoreButton","loader","currentPage","currentQuery","totalLoaded","totalHits","showEndOfCollectionMessage","smoothScroll","galleryItem","itemHeight","event","searchQuery","oldElements"],"mappings":"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"}